--#1 Show Customers (their full names, customer ID, and country) who are not in the US. 
SELECT firstname,lastname,customerID,country
FROM chinook.customers
WHERE country <> 'USA';

--#2 Show only the Customers from Brazil.
SELECT *
FROM chinook.customers
WHERE country = 'Brazil';

--#3 Find the Invoices of customers who are from Brazil. 
SELECT 
customers.firstname, 
customers.lastname, 
invoices.invoiceID, 
invoices.invoicedate, 
invoices.billingcountry
FROM chinook.customers AS customers
LEFT JOIN chinook.invoices AS invoices
ON customers.customerID=invoices.customerID
WHERE invoices.billingcountry='Brazil';

--#4 Show the Employees who are Sales Agents.
SELECT *
FROM chinook.employees
WHERE title='Sales Support Agent';

--#5 Find a unique/distinct list of billing countries from the Invoice table.
SELECT DISTINCT billingcountry
FROM chinook.invoices
ORDER BY billingcountry;

--#6 Provide a query that shows the invoices associated with each sales agent. 
SELECT
employees.lastname,
employees.firstname,
invoices.invoiceID
FROM chinook.employees
INNER JOIN chinook.customers AS cust
ON employees.employeeid=cust.supportrepid
INNER JOIN chinook.invoices AS invoices
ON cust.customerID=invoices.customerID;

--#7 Show the Invoice Total, Customer name, Country, and Sales Agent name for all invoices and customers.
SELECT
emp.lastname AS agent_name,
emp.firstname AS agent_name,
cust.firstname AS cust_name,
cust.lastname AS cust_name,
cust.country,
invoices.total
FROM chinook.employees AS emp
JOIN chinook.customers AS cust
ON emp.employeeid=cust.supportrepid
JOIN chinook.invoices AS invoices
ON cust.customerid=invoices.customerid;

--#8 How many Invoices were there in 2009?
SELECT COUNT(invoiceid) AS Total_invoices
FROM chinook.invoices
WHERE invoicedate LIKE '%2009%'

--#9 What are the total sales for 2009?
SELECT SUM(total) AS total_sales
FROM chinook.invoices
WHERE invoicedate LIKE '%2009%';

